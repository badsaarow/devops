# 유스케이스: 배터리 상태 추정 (SWR-BMS-003)

## 개요

- 유스케이스 ID: UC-BMS-003
- 액터: BMS 컨트롤러
- 선행조건:
  - BMS 시스템 정상 작동
  - 전압, 전류, 온도 센서 데이터 수신 중
  - 배터리 사용 이력 데이터 접근 가능
- 후행조건: 배터리 상태 정보(SOC, SOH, SOF) 업데이트 완료

## Basic Path (정상 경로)

### SOC 추정

1. 시스템이 1초 주기로 다음 데이터 수집
   - 현재 전압
   - 전류 적산값
   - 온도
2. 컬럼필터 기반 SOC 추정 알고리즘 실행
3. 추정된 SOC 값 검증 (±5% 정확도 확인)
4. SOC 값 업데이트 및 저장

### SOH 추정

1. 시스템이 1시간 주기로 다음 데이터 수집
   - 충방전 사이클 수
   - 내부 저항 변화
   - 용량 감소율
2. SOH 추정 알고리즘 실행
3. 추정된 SOH 값 검증 (±10% 정확도 확인)
4. SOH 값 업데이트 및 저장

### SOF 계산

1. 시스템이 1초 주기로 다음 데이터 수집
   - 현재 SOC
   - 현재 온도
   - 현재 전류
2. SOF 계산 알고리즘 실행
3. 계산된 SOF 값 검증
4. SOF 값 업데이트 및 저장

## Alternate Paths (대체 경로)

### A1. 센서 데이터 불완전시 SOC 추정

1. 일부 센서 데이터 누락 감지
2. 이전 데이터 기반 보간법 적용
3. 신뢰도 저하 표시와 함께 SOC 추정
4. 불확실성 증가를 로깅

### A2. 극한 온도 조건에서의 상태 추정

1. 극한 온도 상태 감지 (-10°C 이하 또는 45°C 이상)
2. 온도 보정 계수 적용
3. 수정된 알고리즘으로 상태 추정
4. 온도 영향 보정값 적용

### A3. 급격한 부하 변동 시 SOF 재계산

1. 급격한 부하 변동 감지
2. SOF 즉시 재계산 트리거
3. 새로운 부하 조건 반영
4. 업데이트된 SOF 값 전파

## Exception Paths (예외 경로)

### E1. 상태 추정 실패

1. 알고리즘 실행 실패 감지
2. 마지막 유효값 유지
3. 실패 원인 진단
4. 오류 상태 보고 및 로깅
5. 필요시 백업 알고리즘 전환

### E2. 정확도 범위 초과

1. 추정값이 지정된 정확도 범위 초과 감지
   - SOC: ±5% 초과
   - SOH: ±10% 초과
2. 보정 알고리즘 실행
3. 보정 실패시 경고 플래그 설정
4. 상위 시스템에 신뢰도 저하 보고

### E3. 데이터 저장 실패

1. 상태 정보 저장 실패 감지
2. 임시 저장소에 데이터 백업
3. 저장 시스템 진단
4. 오류 복구 시도
5. 지속적 실패시 관리자 알림

## 특수 요구사항

- SOC 추정값의 연속성 보장
- 온도와 노화에 따른 보정 계수 적용
- 모든 상태 추정 이력 저장
- ASIL-B 요구사항에 따른 안전성 보장
  - 상태 추정 결과의 타당성 검증
  - 중복 검증 메커니즘 구현
  - 오류 검출 및 처리

## 성능 요구사항

- SOC 추정: 1초 이내 완료
- SOH 추정: 3초 이내 완료
- SOF 계산: 100ms 이내 완료
- 메모리 사용량: 지정된 한도 내 유지
